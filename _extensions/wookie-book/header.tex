\usepackage{geometry}
\usepackage{xcolor}
\usepackage{eso-pic}
\usepackage{fancyhdr}
\usepackage{sectsty}
\usepackage{fontspec}
\usepackage{titlesec}

% Set page geometry.
%
% - A wider right margin.
%
\geometry{a4paper, total={170mm,257mm}, left=20mm, top=20mm, bottom=20mm, right=50mm}

\definecolor{light}{HTML}{E6E6FA}
\definecolor{highlight}{HTML}{800080}
\definecolor{dark}{HTML}{330033}

\AddToShipoutPicture{
    % RHS border
    \AtPageLowerLeft{
        \put(\LenToUnit{\dimexpr\paperwidth-3cm},0){
            \color{light}\rule{3cm}{\LenToUnit\paperheight}
          }
     }
    % Logo
    % \AtPageLowerLeft{
    %     \put(\LenToUnit{\dimexpr\paperwidth-2.25cm},27.2cm){% move it to the top right
    %         \color{light}\includegraphics[width=1.5cm]{_extensions/nrennie/PrettyPDF/logo.png}
    %       }
    %  }
}

\fancypagestyle{mystyle}{
  \fancyhf{}
  \renewcommand\headrulewidth{0pt}
  \fancyfoot[R]{\thepage}
  \fancyfootoffset{3.5cm}
}
\setlength{\footskip}{20pt}

\chapterfont{\color{dark}\fontsize{20}{16.8}\selectfont}
\sectionfont{\color{dark}\fontsize{20}{16.8}\selectfont}
\subsectionfont{\color{dark}\fontsize{14}{16.8}\selectfont}
\titleformat{\subsection}
  {\sffamily\Large\bfseries}{\thesection}{1em}{}[{\titlerule[0.8pt]}]

\makeatletter
\renewcommand{\maketitle}{%
    \bgroup\setlength{\parindent}{0pt}
    \begin{flushleft}
        % Quarto injects code which appends the subtitle after the title.
        {\sffamily\huge\textbf{\@title}}
        \@author
    \end{flushleft}
    \egroup
}
\makeatother

\setsansfont{Ubuntu}[
    Path=_extensions/datawookie/wookie-book/fonts/,
    Scale=0.9,
    Extension = .ttf,
    UprightFont=*-Regular,
    BoldFont=*-Bold,
    ItalicFont=*-Italic,
    ]

\setmainfont{Ubuntu}[
    Path=_extensions/datawookie/wookie-book/fonts/,
    Scale=0.9,
    Extension = .ttf,
    UprightFont=*-Regular,
    BoldFont=*-Bold,
    ItalicFont=*-Italic,
    ]
